%%%% 函数-计算密度

function rho=sea_density(ZG,H0)
z=ZG+H0;
%初值设定
t0=14.9;%当地海平面温度（单位：摄氏度）
S=35;%盐度（取平均海水盐度，单位：PSU）
P0=101325;%海平面压强，单位：Pa

%温度梯度
t=t0-0.7*z/1000;%每1000m下降0.5-1摄氏度
%t=t+273.15;摄氏度转换为开氏温标

%压强梯度
P=P0+z*P0/10;

%标准平均海水密度
rho_s=999.842594+6.793952e-2*2-9.09529e-3*t^2+1.001685e-4*t^3-1.120083e-6*t^4+6.536332e-9*t^5;

%一个大气压下的海水密度方程
rho0=rho_s+(8.24493e-1-4.0899e-3*t+7.6438e-5*t^2-8.2467e-7*t^3+5.3875e-9*t^4)*S+(-5.72466e-3+1.0227e-4*t-1.6546e-6*t^2)*S^(3/2)+4.8314e-4*S^2;

%计算正割体积模量
Kw=19652.21+148.4206*t-2.327105*t^2+1.360477e-2*t^3-5.155288e-5*t^4;
Aw=3.239908+1.43713e-3*t+1.16092e-4*t^2-5.77905e-7*t^3;
Bw=8.50935e-5-6.12293e-6*t+5.2987e-8*t^2;

K0=Kw+(54.6746-0.603459*t+1.09987e-2*t^2-6.1670e-5*t^3)*S+(7.944e-2+1.6483e-3*t-5.3009e-4*t^2)*S^(3/2);
A=Aw+(2.2838e-3-1.0981e-5*t-1.6078e-6*t^2)*S+1.91075e-4*S^(3/2);
B=Bw+(-9.9348e-7+2.0816e-8*t+9.1697e-10*t^2)*S;

K=K0+A*P+B*P^2;

%计算高压海水密度
rho=rho0/(1-P/K);